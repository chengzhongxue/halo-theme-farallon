var __extends=this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}))(t,e)};return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();function isEmailValid(t){return t.includes("@")}function isUrlValid(t){return t.includes("http")}var farallonBase=function(){function t(){this.is_single=!1,this.post_id=0,this.is_archive=!1,this.darkmode=!1,this.is_single=obvInit.is_single,this.post_id=obvInit.post_id,this.is_archive=obvInit.is_archive,this.darkmode=obvInit.darkmode,this.VERSION=obvInit.version}return t.prototype.getCookie=function(t){if(0<document.cookie.length){var e=document.cookie.indexOf(t+"=");if(-1!=e)return e=e+t.length+1,-1==(t=document.cookie.indexOf(";",e))&&(t=document.cookie.length),document.cookie.substring(e,t)}return""},t.prototype.setCookie=function(t,e,o){var n=new Date,o=(n.setTime(n.getTime()+24*o*60*60*1e3),"expires="+n.toUTCString());document.cookie=t+"="+e+";"+o+";path=/"},t.prototype.showNotice=function(t,e){void 0===e&&(e="success");e='<div class="notice--wrapper">'.concat(t,"</div>");document.querySelector("body").insertAdjacentHTML("beforeend",e),document.querySelector(".notice--wrapper").classList.add("is-active"),setTimeout(function(){document.querySelector(".notice--wrapper").remove()},3e3)},t}(),farallonAction=function(o){function t(){var t=o.call(this)||this,e=(t.selctor=".like-btn",t.post_id=0,t.post_id=obvInit.post_id,t.like_btn=document.querySelector(t.selctor),t.like_btn&&(t.like_btn.addEventListener("click",function(){t.handleLike()}),t.getCookie("like_"+t.post_id))&&t.like_btn.classList.add("is-active"),localStorage.getItem("theme")?localStorage.getItem("theme"):"auto"),e='<div class="fixed--theme">\n        <span class="'.concat("dark"==e?"is-active":"",'" data-action-value="dark">\n            <svg fill="none" height="24" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"\n                stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="24"\n                style="color: currentcolor; width: 16px; height: 16px;">\n                <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>\n            </svg>\n        </span>\n        <span class="').concat("light"==e?"is-active":"",'" data-action-value="light">\n            <svg fill="none" height="24" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"\n                stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="24"\n                style="color: currentcolor; width: 16px; height: 16px;">\n                <circle cx="12" cy="12" r="5"></circle>\n                <path d="M12 1v2"></path>\n                <path d="M12 21v2"></path>\n                <path d="M4.22 4.22l1.42 1.42"></path>\n                <path d="M18.36 18.36l1.42 1.42"></path>\n                <path d="M1 12h2"></path>\n                <path d="M21 12h2"></path>\n                <path d="M4.22 19.78l1.42-1.42"></path>\n                <path d="M18.36 5.64l1.42-1.42"></path>\n            </svg>\n        </span>\n        <span class="').concat("auto"==e?"is-active":"",'"  data-action-value="auto">\n            <svg fill="none" height="24" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"\n                stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="24"\n                style="color: currentcolor; width: 16px; height: 16px;">\n                <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>\n                <path d="M8 21h8"></path>\n                <path d="M12 17v4"></path>\n            </svg>\n        </span>\n    </div>'),e=(t.darkmode&&document.querySelector("body").insertAdjacentHTML("beforeend",e),document.querySelectorAll(".fixed--theme span").forEach(function(e){e.addEventListener("click",function(){var t;e.classList.contains("is-active")||(document.querySelectorAll(".fixed--theme span").forEach(function(t){t.classList.remove("is-active")}),"dark"==e.dataset.actionValue?(t=document.documentElement,localStorage.setItem("theme","dark"),document.querySelector("body").classList.remove("auto"),document.querySelector("body").classList.add("dark"),t.setAttribute("theme","dark"),e.classList.add("is-active")):"light"==e.dataset.actionValue?(t=document.documentElement,localStorage.setItem("theme","light"),document.querySelector("body").classList.remove("auto"),document.querySelector("body").classList.remove("dark"),t.setAttribute("theme","light"),e.classList.add("is-active")):"auto"==e.dataset.actionValue&&(t=document.documentElement,localStorage.setItem("theme","auto"),document.querySelector("body").classList.remove("dark"),document.querySelector("body").classList.add("auto"),t.removeAttribute("theme"),e.classList.add("is-active")))})}),document.querySelector(".post--share")&&document.querySelector(".post--share").addEventListener("click",function(){navigator.clipboard.writeText(document.location.href).then(function(){t.showNotice("复制成功")})}),console.log("theme version: ".concat(t.VERSION," init success!")),'<div class="site--footer__info">\n        Theme <a href="https://github.com/chengzhongxue/halo-theme-farallon" target="_blank">farallon</a> by 困困鱼 / version '.concat(t.VERSION,"\n    </div>"));return document.querySelector(".site--footer__content").insertAdjacentHTML("afterend",e),document.querySelector(".icon--copryrights").addEventListener("click",function(){document.querySelector(".site--footer__info").classList.toggle("active")}),t}return __extends(t,o),t.prototype.handleLike=function(){var e=this;if(this.getCookie("like_"+this.post_id))return this.showNotice("You have already liked this post");fetch("/apis/api.halo.run/v1alpha1/trackers/upvote",{method:"POST",body:JSON.stringify({group:"content.halo.run",plural:"posts",name:this.post_id}),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(function(t){e.showNotice("Thanks for your like"),e.setCookie("like_"+e.post_id,"1",1)}),this.like_btn.classList.add("is-active")},t.prototype.refresh=function(){},t}(farallonBase),farallonPost=(new farallonAction,function(e){function t(){var t=e.call(this)||this;return t.loading=!1,t.page=1,t.init(),t}return __extends(t,e),t.prototype.init=function(){var t,e=this;document.querySelector(".loadmore")&&(this.button=document.querySelector(".loadmore"),null!=(t=document.querySelector(".loadmore")))&&t.addEventListener("click",function(t){t.preventDefault(),e.loading||(e.loading=!0,e.page++,e.fetchPosts())})},t.prototype.randerPosts=function(t){var e,t=t.map(function(t){var e=obvInit.hide_home_cover||!t.has_image?"":'<a href="'.concat(t.permalink,'" aria-label="').concat(t.post_title,'" class="cover--link">\n                <img src="').concat(t.thumbnail,'" class="cover" alt="').concat(t.post_title,'">\n                        </a>');return'<article class="post--item" itemtype="http://schema.org/Article" itemscope="itemscope">\n            <div class="content">\n                <h2 class="post--title" itemprop="headline">\n                    <a href="'.concat(t.permalink,'" aria-label="').concat(t.post_title,'">\n                        ').concat(t.post_title,'</a>\n                </h2>\n                <div class="description" itemprop="about">').concat(t.excerpt,'</div>\n                <div class="meta">\n                    <svg class="icon" viewBox="0 0 1024 1024" width="16" height="16">\n                        <path d="M512 97.52381c228.912762 0 414.47619 185.563429 414.47619 414.47619s-185.563429 414.47619-414.47619 414.47619S97.52381 740.912762 97.52381 512 283.087238 97.52381 512 97.52381z m0 73.142857C323.486476 170.666667 170.666667 323.486476 170.666667 512s152.81981 341.333333 341.333333 341.333333 341.333333-152.81981 341.333333-341.333333S700.513524 170.666667 512 170.666667z m36.571429 89.697523v229.86362h160.865523v73.142857H512a36.571429 36.571429 0 0 1-36.571429-36.571429V260.388571h73.142858z"></path>\n                    </svg>\n                    <time itemprop="datePublished" datetime="" class="humane--time">').concat(t.date,"</time>\n                                                    </div>\n            </div>").concat(e,"\n            </article>")}).join("");null!=(e=document.querySelector(".posts--list"))&&(e.innerHTML+=t)},t.prototype.fetchPosts=function(){var o=this;this.button.innerHTML="加载中...",fetch(obvInit.restfulBase+"farallon/v1/posts?page="+this.page,{method:"get",headers:{"X-WP-Nonce":obvInit.nonce,"Content-Type":"application/json"}}).then(function(t){return t.json()}).then(function(t){var e;if(o.loading=!1,200!=t.code)return o.showNotice(t.message,"error");0==t.data.length?(null!=(e=document.querySelector(".loadmore"))&&e.remove(),o.showNotice("没有更多文章了","error")):(o.randerPosts(t.data),o.showNotice("加载成功","error")),o.button.innerHTML="加载更多"})},t}(farallonBase)),farallonScroll=(new farallonPost,function(){function t(){var t;this.is_single=!1,this.is_single=obvInit.is_single,this.init(),document.querySelector(".backToTop")&&(t=document.querySelector(".backToTop"),window.addEventListener("scroll",function(){200<(window.scrollY||window.pageYOffset)?t.classList.add("is-active"):t.classList.remove("is-active")}),t.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})}))}return t.prototype.init=function(){this.scroll()},t.prototype.scroll=function(){var e=this,t=document.querySelector(".post-navigation"),o=t?t.offsetTop:0,n=window.innerHeight;window.addEventListener("scroll",function(){var t;10<window.scrollY?null!=(t=document.querySelector(".site--header"))&&t.classList.add("is-active"):null!=(t=document.querySelector(".site--header"))&&t.classList.remove("is-active"),e.is_single&&(window.scrollY>o-n?null!=(t=document.querySelector(".post-navigation"))&&t.classList.add("is-active"):null!=(t=document.querySelector(".post-navigation"))&&t.classList.remove("is-active"))})},t}());new farallonScroll;